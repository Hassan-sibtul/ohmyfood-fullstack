{"ast":null,"code":"var _jsxFileName = \"/Users/sibtulhassan/Downloads/ohmyfood-fullstack/client/src/pages/Payment.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { useEffect, useState } from \"react\";\nimport { useLocation } from \"react-router-dom\";\nimport { loadStripe } from \"@stripe/stripe-js\";\nimport { Elements, PaymentElement, useStripe, useElements } from \"@stripe/react-stripe-js\";\nimport API from \"../api\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst stripePromise = loadStripe(\"pk_test_51SL4gHFrLsiRJStWdnqFsEdHiiDQYDvTOGEe53lwevsgEMz2PxhP4QjKcqgbf8h2N8EKmkIXIDLfELusYLepJqNE00oIRsCveh\"); // your Stripe publishable key\n\nfunction CheckoutForm({\n  cart\n}) {\n  _s();\n  const stripe = useStripe();\n  const elements = useElements();\n  const total = cart.reduce((sum, item) => sum + item.price * item.qty, 0);\n  const handleSubmit = async e => {\n    e.preventDefault();\n    if (!stripe || !elements) return;\n    const {\n      error\n    } = await stripe.confirmPayment({\n      elements,\n      confirmParams: {\n        return_url: \"http://localhost:3000/order-confirmation\"\n      }\n    });\n    if (error) {\n      alert(error.message);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"form\", {\n    onSubmit: handleSubmit,\n    className: \"payment-form\",\n    children: [/*#__PURE__*/_jsxDEV(PaymentElement, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 40,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"submit\",\n      disabled: !stripe,\n      className: \"btn-primary\",\n      children: [\"Pay \\xA3\", total.toFixed(2)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 41,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 39,\n    columnNumber: 5\n  }, this);\n}\n_s(CheckoutForm, \"EKvoGMX7lxsZ5SGPpYu2aKFzClQ=\", false, function () {\n  return [useStripe, useElements];\n});\n_c = CheckoutForm;\nexport default function Payment() {\n  _s2();\n  const location = useLocation();\n  const {\n    cart\n  } = location.state || {\n    cart: []\n  };\n  const [clientSecret, setClientSecret] = useState(null);\n  const total = cart.reduce((sum, item) => sum + item.price * item.qty, 0);\n  useEffect(() => {\n    API.post(\"/payment/create-payment-intent\", {\n      amount: total\n    }).then(res => setClientSecret(res.data.clientSecret)).catch(console.error);\n  }, [total]);\n  if (!clientSecret) return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: \"Loading payment form...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 61,\n    columnNumber: 29\n  }, this);\n  return /*#__PURE__*/_jsxDEV(Elements, {\n    stripe: stripePromise,\n    options: {\n      clientSecret\n    },\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"payment-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Pay with card\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(CheckoutForm, {\n        cart: cart\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 64,\n    columnNumber: 5\n  }, this);\n}\n_s2(Payment, \"ZC5W70MbULbRsrWo+WXfFklgO48=\", false, function () {\n  return [useLocation];\n});\n_c2 = Payment;\nvar _c, _c2;\n$RefreshReg$(_c, \"CheckoutForm\");\n$RefreshReg$(_c2, \"Payment\");","map":{"version":3,"names":["React","useEffect","useState","useLocation","loadStripe","Elements","PaymentElement","useStripe","useElements","API","jsxDEV","_jsxDEV","stripePromise","CheckoutForm","cart","_s","stripe","elements","total","reduce","sum","item","price","qty","handleSubmit","e","preventDefault","error","confirmPayment","confirmParams","return_url","alert","message","onSubmit","className","children","fileName","_jsxFileName","lineNumber","columnNumber","type","disabled","toFixed","_c","Payment","_s2","location","state","clientSecret","setClientSecret","post","amount","then","res","data","catch","console","options","_c2","$RefreshReg$"],"sources":["/Users/sibtulhassan/Downloads/ohmyfood-fullstack/client/src/pages/Payment.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { useLocation } from \"react-router-dom\";\nimport { loadStripe } from \"@stripe/stripe-js\";\nimport {\n  Elements,\n  PaymentElement,\n  useStripe,\n  useElements,\n} from \"@stripe/react-stripe-js\";\nimport API from \"../api\";\n\nconst stripePromise = loadStripe(\n  \"pk_test_51SL4gHFrLsiRJStWdnqFsEdHiiDQYDvTOGEe53lwevsgEMz2PxhP4QjKcqgbf8h2N8EKmkIXIDLfELusYLepJqNE00oIRsCveh\"\n); // your Stripe publishable key\n\nfunction CheckoutForm({ cart }) {\n  const stripe = useStripe();\n  const elements = useElements();\n\n  const total = cart.reduce((sum, item) => sum + item.price * item.qty, 0);\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    if (!stripe || !elements) return;\n\n    const { error } = await stripe.confirmPayment({\n      elements,\n      confirmParams: {\n        return_url: \"http://localhost:3000/order-confirmation\",\n      },\n    });\n\n    if (error) {\n      alert(error.message);\n    }\n  };\n\n  return (\n    <form onSubmit={handleSubmit} className=\"payment-form\">\n      <PaymentElement />\n      <button type=\"submit\" disabled={!stripe} className=\"btn-primary\">\n        Pay Â£{total.toFixed(2)}\n      </button>\n    </form>\n  );\n}\n\nexport default function Payment() {\n  const location = useLocation();\n  const { cart } = location.state || { cart: [] };\n  const [clientSecret, setClientSecret] = useState(null);\n\n  const total = cart.reduce((sum, item) => sum + item.price * item.qty, 0);\n\n  useEffect(() => {\n    API.post(\"/payment/create-payment-intent\", { amount: total })\n      .then((res) => setClientSecret(res.data.clientSecret))\n      .catch(console.error);\n  }, [total]);\n\n  if (!clientSecret) return <div>Loading payment form...</div>;\n\n  return (\n    <Elements stripe={stripePromise} options={{ clientSecret }}>\n      <div className=\"payment-container\">\n        <h2>Pay with card</h2>\n        <CheckoutForm cart={cart} />\n      </div>\n    </Elements>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}