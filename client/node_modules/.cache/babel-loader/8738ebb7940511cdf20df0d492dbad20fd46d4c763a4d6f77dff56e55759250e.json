{"ast":null,"code":"var _jsxFileName = \"/Users/sibtulhassan/Downloads/ohmyfood-fullstack/client/src/pages/Payment.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React from \"react\";\nimport { useLocation, useNavigate } from \"react-router-dom\";\nimport { loadStripe } from \"@stripe/stripe-js\";\nimport { Elements, CardElement, useStripe, useElements } from \"@stripe/react-stripe-js\";\nimport API from \"../api\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst stripePromise = loadStripe(\"pk_test_XXXXXXXXXXXXXXXXXXXXXXXX\"); // your publishable key\n\nfunction CheckoutForm({\n  address,\n  cart\n}) {\n  _s();\n  const stripe = useStripe();\n  const elements = useElements();\n  const navigate = useNavigate();\n  const total = cart.reduce((sum, item) => sum + item.price * item.qty, 0);\n  const handleSubmit = async e => {\n    e.preventDefault();\n    if (!stripe || !elements) return;\n\n    // Ask backend for clientSecret\n    const {\n      data\n    } = await API.post(\"/payment/create-payment-intent\", {\n      amount: total\n    });\n    const result = await stripe.confirmCardPayment(data.clientSecret, {\n      payment_method: {\n        card: elements.getElement(CardElement),\n        billing_details: {\n          name: \"Test User\" // you can add address.name field if collected earlier\n        }\n      }\n    });\n    if (result.error) {\n      alert(result.error.message);\n    } else {\n      if (result.paymentIntent.status === \"succeeded\") {\n        alert(\"Payment successful ðŸŽ‰\");\n        localStorage.removeItem(\"cart\");\n        navigate(\"/\", {\n          replace: true\n        });\n      }\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"form\", {\n    onSubmit: handleSubmit,\n    className: \"payment-form\",\n    children: [/*#__PURE__*/_jsxDEV(CardElement, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"submit\",\n      disabled: !stripe,\n      className: \"btn-primary\",\n      children: [\"Pay \\xA3\", total.toFixed(2)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 52,\n    columnNumber: 5\n  }, this);\n}\n_s(CheckoutForm, \"dItBdZQNKexsv+t0LqYtwDgt2wQ=\", false, function () {\n  return [useStripe, useElements, useNavigate];\n});\n_c = CheckoutForm;\nexport default function Payment() {\n  _s2();\n  const location = useLocation();\n  const {\n    address,\n    cart\n  } = location.state || {\n    address: {},\n    cart: []\n  };\n  return /*#__PURE__*/_jsxDEV(Elements, {\n    stripe: stripePromise,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"payment-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Payment\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(CheckoutForm, {\n        address: address,\n        cart: cart\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 66,\n    columnNumber: 5\n  }, this);\n}\n_s2(Payment, \"pkHmaVRPskBaU4tMJuJJpV42k1I=\", false, function () {\n  return [useLocation];\n});\n_c2 = Payment;\nvar _c, _c2;\n$RefreshReg$(_c, \"CheckoutForm\");\n$RefreshReg$(_c2, \"Payment\");","map":{"version":3,"names":["React","useLocation","useNavigate","loadStripe","Elements","CardElement","useStripe","useElements","API","jsxDEV","_jsxDEV","stripePromise","CheckoutForm","address","cart","_s","stripe","elements","navigate","total","reduce","sum","item","price","qty","handleSubmit","e","preventDefault","data","post","amount","result","confirmCardPayment","clientSecret","payment_method","card","getElement","billing_details","name","error","alert","message","paymentIntent","status","localStorage","removeItem","replace","onSubmit","className","children","fileName","_jsxFileName","lineNumber","columnNumber","type","disabled","toFixed","_c","Payment","_s2","location","state","_c2","$RefreshReg$"],"sources":["/Users/sibtulhassan/Downloads/ohmyfood-fullstack/client/src/pages/Payment.js"],"sourcesContent":["import React from \"react\";\nimport { useLocation, useNavigate } from \"react-router-dom\";\nimport { loadStripe } from \"@stripe/stripe-js\";\nimport {\n  Elements,\n  CardElement,\n  useStripe,\n  useElements,\n} from \"@stripe/react-stripe-js\";\nimport API from \"../api\";\n\nconst stripePromise = loadStripe(\"pk_test_XXXXXXXXXXXXXXXXXXXXXXXX\"); // your publishable key\n\nfunction CheckoutForm({ address, cart }) {\n  const stripe = useStripe();\n  const elements = useElements();\n  const navigate = useNavigate();\n\n  const total = cart.reduce((sum, item) => sum + item.price * item.qty, 0);\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n\n    if (!stripe || !elements) return;\n\n    // Ask backend for clientSecret\n    const { data } = await API.post(\"/payment/create-payment-intent\", {\n      amount: total,\n    });\n\n    const result = await stripe.confirmCardPayment(data.clientSecret, {\n      payment_method: {\n        card: elements.getElement(CardElement),\n        billing_details: {\n          name: \"Test User\", // you can add address.name field if collected earlier\n        },\n      },\n    });\n\n    if (result.error) {\n      alert(result.error.message);\n    } else {\n      if (result.paymentIntent.status === \"succeeded\") {\n        alert(\"Payment successful ðŸŽ‰\");\n        localStorage.removeItem(\"cart\");\n        navigate(\"/\", { replace: true });\n      }\n    }\n  };\n\n  return (\n    <form onSubmit={handleSubmit} className=\"payment-form\">\n      <CardElement />\n      <button type=\"submit\" disabled={!stripe} className=\"btn-primary\">\n        Pay Â£{total.toFixed(2)}\n      </button>\n    </form>\n  );\n}\n\nexport default function Payment() {\n  const location = useLocation();\n  const { address, cart } = location.state || { address: {}, cart: [] };\n\n  return (\n    <Elements stripe={stripePromise}>\n      <div className=\"payment-container\">\n        <h2>Payment</h2>\n        <CheckoutForm address={address} cart={cart} />\n      </div>\n    </Elements>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}