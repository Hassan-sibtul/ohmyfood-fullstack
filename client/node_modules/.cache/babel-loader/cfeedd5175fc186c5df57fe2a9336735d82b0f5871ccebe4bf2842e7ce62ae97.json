{"ast":null,"code":"var _jsxFileName = \"/Users/sibtulhassan/Downloads/ohmyfood-fullstack/client/src/pages/Payment.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { useContext, useEffect, useState } from \"react\";\nimport { useLocation, useNavigate } from \"react-router-dom\";\nimport { loadStripe } from \"@stripe/stripe-js\";\nimport { CartContext } from \"../context/CartContext\";\nimport { Elements, CardElement, useStripe, useElements } from \"@stripe/react-stripe-js\";\nimport API from \"../api\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst stripePromise = loadStripe(\"pk_test_51SL4gHFrLsiRJStWdnqFsEdHiiDQYDvTOGEe53lwevsgEMz2PxhP4QjKcqgbf8h2N8EKmkIXIDLfELusYLepJqNE00oIRsCveh\");\nfunction CheckoutForm({\n  address,\n  cart\n}) {\n  _s();\n  const stripe = useStripe();\n  const elements = useElements();\n  const navigate = useNavigate();\n  const {\n    clearCart\n  } = useContext(CartContext);\n  const [loading, setLoading] = useState(false);\n  const subtotal = cart.reduce((sum, item) => sum + (item.price || 0) * (item.qty || 0), 0);\n\n  // ‚úÖ Billing + loyalty point states\n  const [billingDetails, setBillingDetails] = useState({\n    name: \"\",\n    email: \"\",\n    line1: \"\",\n    city: \"\",\n    postcode: \"\",\n    country: \"GB\" // Default for UK\n  });\n  const [userPoints, setUserPoints] = useState(0);\n  const [pointsToUse, setPointsToUse] = useState(0);\n  const [discount, setDiscount] = useState(0);\n  const total = Math.max(subtotal - discount, 0);\n\n  // ‚úÖ Fetch saved profile + loyalty points\n  useEffect(() => {\n    const fetchProfile = async () => {\n      try {\n        var _profileRes$data, _loyaltyRes$data;\n        const token = localStorage.getItem(\"token\");\n        if (!token) return;\n        const [profileRes, loyaltyRes] = await Promise.all([API.get(\"/api/users/profile\", {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        }), API.get(\"/api/users/loyalty\", {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        })]);\n        if ((_profileRes$data = profileRes.data) !== null && _profileRes$data !== void 0 && _profileRes$data.billingDetails) setBillingDetails(profileRes.data.billingDetails);\n        if ((_loyaltyRes$data = loyaltyRes.data) !== null && _loyaltyRes$data !== void 0 && _loyaltyRes$data.loyaltyPoints) setUserPoints(loyaltyRes.data.loyaltyPoints);\n      } catch (err) {\n        console.warn(\"‚ö†Ô∏è Could not load user profile/points:\", err === null || err === void 0 ? void 0 : err.message);\n      }\n    };\n    fetchProfile();\n  }, []);\n  const handleChange = e => {\n    setBillingDetails({\n      ...billingDetails,\n      [e.target.name]: e.target.value\n    });\n  };\n\n  // üí∞ Apply loyalty points for discount\n  const handleApplyPoints = () => {\n    if (pointsToUse <= 0 || pointsToUse > userPoints) {\n      alert(\"Enter a valid number of points to redeem.\");\n      return;\n    }\n    const discountValue = pointsToUse * 0.01; // 1 point = ¬£0.01\n    if (discountValue > subtotal) {\n      alert(\"You cannot apply more points than the subtotal amount.\");\n      return;\n    }\n    setDiscount(discountValue);\n  };\n  const handleSubmit = async e => {\n    e.preventDefault();\n    const token = localStorage.getItem(\"token\");\n    if (!token) return alert(\"You must be logged in to make a payment.\");\n    if (!stripe || !elements) return alert(\"Stripe not ready yet.\");\n    setLoading(true);\n    try {\n      const payableAmount = subtotal - discount;\n\n      // 1Ô∏è‚É£ Create Stripe payment intent\n      const {\n        data: paymentIntent\n      } = await API.post(\"/api/payment/create-payment-intent\", {\n        amount: Math.round(payableAmount * 100)\n      }, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      const clientSecret = paymentIntent === null || paymentIntent === void 0 ? void 0 : paymentIntent.clientSecret;\n      if (!clientSecret) throw new Error(\"Missing client secret from server.\");\n\n      // 2Ô∏è‚É£ Confirm card payment\n      const card = elements.getElement(CardElement);\n      const confirm = await stripe.confirmCardPayment(clientSecret, {\n        payment_method: {\n          card,\n          billing_details: {\n            name: billingDetails.name,\n            email: billingDetails.email,\n            address: {\n              line1: billingDetails.line1,\n              postal_code: billingDetails.postcode,\n              // ‚úÖ UK-friendly\n              city: billingDetails.city,\n              country: billingDetails.country\n            }\n          }\n        }\n      });\n      if (confirm.error) throw confirm.error;\n      if (confirm.paymentIntent.status !== \"succeeded\") throw new Error(\"Payment not successful.\");\n\n      // 3Ô∏è‚É£ Group items by restaurant\n      const groupedByRestaurant = cart.reduce((acc, item) => {\n        if (!item.restaurantId) {\n          console.warn(\"Item missing restaurantId:\", item);\n          return acc;\n        }\n        if (!acc[item.restaurantId]) acc[item.restaurantId] = [];\n        acc[item.restaurantId].push(item);\n        return acc;\n      }, {});\n      const createdOrders = [];\n\n      // 4Ô∏è‚É£ Create an order for each restaurant\n      for (const [restaurantId, items] of Object.entries(groupedByRestaurant)) {\n        const orderTotal = items.reduce((sum, i) => sum + i.price * i.qty, 0);\n        const orderRes = await API.post(\"/api/orders\", {\n          restaurantId,\n          items,\n          totalAmount: orderTotal,\n          address\n        }, {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        createdOrders.push(orderRes.data);\n      }\n\n      // 5Ô∏è‚É£ Deduct redeemed points\n      if (pointsToUse > 0) {\n        try {\n          await API.put(\"/api/users/redeem\", {\n            pointsToRedeem: pointsToUse\n          }, {\n            headers: {\n              Authorization: `Bearer ${token}`\n            }\n          });\n          console.log(`üíé Redeemed ${pointsToUse} points`);\n        } catch (err) {\n          console.warn(\"‚ö†Ô∏è Could not redeem points:\", err === null || err === void 0 ? void 0 : err.message);\n        }\n      }\n\n      // 6Ô∏è‚É£ Save billing info for next time\n      try {\n        await API.put(\"/api/users/profile\", {\n          billingDetails\n        }, {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n      } catch (err) {\n        console.warn(\"Profile update failed:\", err === null || err === void 0 ? void 0 : err.message);\n      }\n\n      // 7Ô∏è‚É£ Clear cart & redirect\n      clearCart();\n      localStorage.removeItem(\"cart\");\n      navigate(\"/order-confirmation\", {\n        state: {\n          total: payableAmount,\n          orders: createdOrders\n        },\n        replace: true\n      });\n    } catch (err) {\n      console.error(\"‚ùå Payment error:\", err);\n      alert((err === null || err === void 0 ? void 0 : err.message) || \"Payment failed. Please check your card details and try again.\");\n    } finally {\n      setLoading(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"form\", {\n    onSubmit: handleSubmit,\n    className: \"payment-form\",\n    children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n      children: \"Billing Information\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 207,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"text\",\n      name: \"name\",\n      placeholder: \"Cardholder Name\",\n      value: billingDetails.name,\n      onChange: handleChange,\n      required: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"email\",\n      name: \"email\",\n      placeholder: \"Email\",\n      value: billingDetails.email,\n      onChange: handleChange,\n      required: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"text\",\n      name: \"line1\",\n      placeholder: \"Street Address\",\n      value: billingDetails.line1,\n      onChange: handleChange,\n      required: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 224,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"text\",\n      name: \"city\",\n      placeholder: \"City\",\n      value: billingDetails.city,\n      onChange: handleChange,\n      required: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 232,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"text\",\n      name: \"postcode\",\n      placeholder: \"Postcode\",\n      value: billingDetails.postcode,\n      onChange: handleChange,\n      required: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 240,\n      columnNumber: 7\n    }, this), userPoints > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        border: \"1px solid #ddd\",\n        borderRadius: \"8px\",\n        padding: \"10px\",\n        margin: \"15px 0\",\n        background: \"#f8f8f8\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        children: \"Redeem Loyalty Points\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 260,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"You have \", /*#__PURE__*/_jsxDEV(\"strong\", {\n          children: userPoints\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 262,\n          columnNumber: 22\n        }, this), \" points ( \\xA3\", (userPoints * 0.01).toFixed(2), \" value)\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 261,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"number\",\n        value: pointsToUse,\n        onChange: e => setPointsToUse(Number(e.target.value)),\n        min: \"0\",\n        max: userPoints,\n        style: {\n          marginRight: \"10px\",\n          padding: \"5px\"\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 265,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"button\",\n        onClick: handleApplyPoints,\n        style: {\n          background: \"#ff385c\",\n          color: \"#fff\",\n          border: \"none\",\n          padding: \"5px 10px\",\n          borderRadius: \"5px\",\n          cursor: \"pointer\"\n        },\n        children: \"Apply\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 273,\n        columnNumber: 11\n      }, this), discount > 0 && /*#__PURE__*/_jsxDEV(\"p\", {\n        style: {\n          marginTop: \"5px\"\n        },\n        children: [\"Discount applied: \", /*#__PURE__*/_jsxDEV(\"strong\", {\n          children: [\"\\xA3\", discount.toFixed(2)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 289,\n          columnNumber: 33\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 288,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 251,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        borderTop: \"1px solid #ddd\",\n        marginTop: \"15px\",\n        paddingTop: \"10px\",\n        fontSize: \"0.95rem\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Subtotal:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 305,\n          columnNumber: 11\n        }, this), \" \\xA3\", subtotal.toFixed(2)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 304,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Discount:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 308,\n          columnNumber: 11\n        }, this), \" \", discount > 0 ? `-¬£${discount.toFixed(2)}` : \"¬£0.00\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 307,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Total to Pay:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 312,\n          columnNumber: 11\n        }, this), \" \", /*#__PURE__*/_jsxDEV(\"span\", {\n          style: {\n            color: \"#ff385c\",\n            fontSize: \"1.1em\"\n          },\n          children: [\"\\xA3\", total.toFixed(2)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 313,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 311,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 296,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n      style: {\n        marginTop: \"20px\"\n      },\n      children: \"Payment\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 319,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        border: \"1px solid #ddd\",\n        padding: 10,\n        borderRadius: 6\n      },\n      children: /*#__PURE__*/_jsxDEV(CardElement, {\n        options: {\n          hidePostalCode: true\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 321,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 320,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"submit\",\n      disabled: !stripe || loading,\n      className: \"btn-primary\",\n      style: {\n        marginTop: 12\n      },\n      children: loading ? \"Processing...\" : `Pay ¬£${total.toFixed(2)}`\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 324,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 206,\n    columnNumber: 5\n  }, this);\n}\n_s(CheckoutForm, \"bPrNXi/rlp5Mf/31Oo/VACtUD00=\", false, function () {\n  return [useStripe, useElements, useNavigate];\n});\n_c = CheckoutForm;\nexport default function Payment() {\n  _s2();\n  const location = useLocation();\n  const {\n    address,\n    cart\n  } = location.state || {\n    address: {},\n    cart: []\n  };\n  return /*#__PURE__*/_jsxDEV(Elements, {\n    stripe: stripePromise,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"payment-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Payment\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 343,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(CheckoutForm, {\n        address: address,\n        cart: cart\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 344,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 342,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 341,\n    columnNumber: 5\n  }, this);\n}\n_s2(Payment, \"pkHmaVRPskBaU4tMJuJJpV42k1I=\", false, function () {\n  return [useLocation];\n});\n_c2 = Payment;\nvar _c, _c2;\n$RefreshReg$(_c, \"CheckoutForm\");\n$RefreshReg$(_c2, \"Payment\");","map":{"version":3,"names":["React","useContext","useEffect","useState","useLocation","useNavigate","loadStripe","CartContext","Elements","CardElement","useStripe","useElements","API","jsxDEV","_jsxDEV","stripePromise","CheckoutForm","address","cart","_s","stripe","elements","navigate","clearCart","loading","setLoading","subtotal","reduce","sum","item","price","qty","billingDetails","setBillingDetails","name","email","line1","city","postcode","country","userPoints","setUserPoints","pointsToUse","setPointsToUse","discount","setDiscount","total","Math","max","fetchProfile","_profileRes$data","_loyaltyRes$data","token","localStorage","getItem","profileRes","loyaltyRes","Promise","all","get","headers","Authorization","data","loyaltyPoints","err","console","warn","message","handleChange","e","target","value","handleApplyPoints","alert","discountValue","handleSubmit","preventDefault","payableAmount","paymentIntent","post","amount","round","clientSecret","Error","card","getElement","confirm","confirmCardPayment","payment_method","billing_details","postal_code","error","status","groupedByRestaurant","acc","restaurantId","push","createdOrders","items","Object","entries","orderTotal","i","orderRes","totalAmount","put","pointsToRedeem","log","removeItem","state","orders","replace","onSubmit","className","children","fileName","_jsxFileName","lineNumber","columnNumber","type","placeholder","onChange","required","style","border","borderRadius","padding","margin","background","toFixed","Number","min","marginRight","onClick","color","cursor","marginTop","borderTop","paddingTop","fontSize","options","hidePostalCode","disabled","_c","Payment","_s2","location","_c2","$RefreshReg$"],"sources":["/Users/sibtulhassan/Downloads/ohmyfood-fullstack/client/src/pages/Payment.js"],"sourcesContent":["import React, { useContext, useEffect, useState } from \"react\";\nimport { useLocation, useNavigate } from \"react-router-dom\";\nimport { loadStripe } from \"@stripe/stripe-js\";\nimport { CartContext } from \"../context/CartContext\";\nimport {\n  Elements,\n  CardElement,\n  useStripe,\n  useElements,\n} from \"@stripe/react-stripe-js\";\nimport API from \"../api\";\n\nconst stripePromise = loadStripe(\n  \"pk_test_51SL4gHFrLsiRJStWdnqFsEdHiiDQYDvTOGEe53lwevsgEMz2PxhP4QjKcqgbf8h2N8EKmkIXIDLfELusYLepJqNE00oIRsCveh\"\n);\n\nfunction CheckoutForm({ address, cart }) {\n  const stripe = useStripe();\n  const elements = useElements();\n  const navigate = useNavigate();\n  const { clearCart } = useContext(CartContext);\n  const [loading, setLoading] = useState(false);\n\n  const subtotal = cart.reduce(\n    (sum, item) => sum + (item.price || 0) * (item.qty || 0),\n    0\n  );\n\n  // ‚úÖ Billing + loyalty point states\n  const [billingDetails, setBillingDetails] = useState({\n    name: \"\",\n    email: \"\",\n    line1: \"\",\n    city: \"\",\n    postcode: \"\",\n    country: \"GB\", // Default for UK\n  });\n\n  const [userPoints, setUserPoints] = useState(0);\n  const [pointsToUse, setPointsToUse] = useState(0);\n  const [discount, setDiscount] = useState(0);\n\n  const total = Math.max(subtotal - discount, 0);\n\n  // ‚úÖ Fetch saved profile + loyalty points\n  useEffect(() => {\n    const fetchProfile = async () => {\n      try {\n        const token = localStorage.getItem(\"token\");\n        if (!token) return;\n\n        const [profileRes, loyaltyRes] = await Promise.all([\n          API.get(\"/api/users/profile\", {\n            headers: { Authorization: `Bearer ${token}` },\n          }),\n          API.get(\"/api/users/loyalty\", {\n            headers: { Authorization: `Bearer ${token}` },\n          }),\n        ]);\n\n        if (profileRes.data?.billingDetails)\n          setBillingDetails(profileRes.data.billingDetails);\n        if (loyaltyRes.data?.loyaltyPoints)\n          setUserPoints(loyaltyRes.data.loyaltyPoints);\n      } catch (err) {\n        console.warn(\"‚ö†Ô∏è Could not load user profile/points:\", err?.message);\n      }\n    };\n    fetchProfile();\n  }, []);\n\n  const handleChange = (e) => {\n    setBillingDetails({ ...billingDetails, [e.target.name]: e.target.value });\n  };\n\n  // üí∞ Apply loyalty points for discount\n  const handleApplyPoints = () => {\n    if (pointsToUse <= 0 || pointsToUse > userPoints) {\n      alert(\"Enter a valid number of points to redeem.\");\n      return;\n    }\n    const discountValue = pointsToUse * 0.01; // 1 point = ¬£0.01\n    if (discountValue > subtotal) {\n      alert(\"You cannot apply more points than the subtotal amount.\");\n      return;\n    }\n    setDiscount(discountValue);\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    const token = localStorage.getItem(\"token\");\n    if (!token) return alert(\"You must be logged in to make a payment.\");\n    if (!stripe || !elements) return alert(\"Stripe not ready yet.\");\n\n    setLoading(true);\n    try {\n      const payableAmount = subtotal - discount;\n\n      // 1Ô∏è‚É£ Create Stripe payment intent\n      const { data: paymentIntent } = await API.post(\n        \"/api/payment/create-payment-intent\",\n        { amount: Math.round(payableAmount * 100) },\n        { headers: { Authorization: `Bearer ${token}` } }\n      );\n\n      const clientSecret = paymentIntent?.clientSecret;\n      if (!clientSecret) throw new Error(\"Missing client secret from server.\");\n\n      // 2Ô∏è‚É£ Confirm card payment\n      const card = elements.getElement(CardElement);\n      const confirm = await stripe.confirmCardPayment(clientSecret, {\n        payment_method: {\n          card,\n          billing_details: {\n            name: billingDetails.name,\n            email: billingDetails.email,\n            address: {\n              line1: billingDetails.line1,\n              postal_code: billingDetails.postcode, // ‚úÖ UK-friendly\n              city: billingDetails.city,\n              country: billingDetails.country,\n            },\n          },\n        },\n      });\n\n      if (confirm.error) throw confirm.error;\n      if (confirm.paymentIntent.status !== \"succeeded\")\n        throw new Error(\"Payment not successful.\");\n\n      // 3Ô∏è‚É£ Group items by restaurant\n      const groupedByRestaurant = cart.reduce((acc, item) => {\n        if (!item.restaurantId) {\n          console.warn(\"Item missing restaurantId:\", item);\n          return acc;\n        }\n        if (!acc[item.restaurantId]) acc[item.restaurantId] = [];\n        acc[item.restaurantId].push(item);\n        return acc;\n      }, {});\n\n      const createdOrders = [];\n\n      // 4Ô∏è‚É£ Create an order for each restaurant\n      for (const [restaurantId, items] of Object.entries(groupedByRestaurant)) {\n        const orderTotal = items.reduce((sum, i) => sum + i.price * i.qty, 0);\n        const orderRes = await API.post(\n          \"/api/orders\",\n          {\n            restaurantId,\n            items,\n            totalAmount: orderTotal,\n            address,\n          },\n          { headers: { Authorization: `Bearer ${token}` } }\n        );\n        createdOrders.push(orderRes.data);\n      }\n\n      // 5Ô∏è‚É£ Deduct redeemed points\n      if (pointsToUse > 0) {\n        try {\n          await API.put(\n            \"/api/users/redeem\",\n            { pointsToRedeem: pointsToUse },\n            { headers: { Authorization: `Bearer ${token}` } }\n          );\n          console.log(`üíé Redeemed ${pointsToUse} points`);\n        } catch (err) {\n          console.warn(\"‚ö†Ô∏è Could not redeem points:\", err?.message);\n        }\n      }\n\n      // 6Ô∏è‚É£ Save billing info for next time\n      try {\n        await API.put(\n          \"/api/users/profile\",\n          { billingDetails },\n          { headers: { Authorization: `Bearer ${token}` } }\n        );\n      } catch (err) {\n        console.warn(\"Profile update failed:\", err?.message);\n      }\n\n      // 7Ô∏è‚É£ Clear cart & redirect\n      clearCart();\n      localStorage.removeItem(\"cart\");\n\n      navigate(\"/order-confirmation\", {\n        state: { total: payableAmount, orders: createdOrders },\n        replace: true,\n      });\n    } catch (err) {\n      console.error(\"‚ùå Payment error:\", err);\n      alert(\n        err?.message ||\n          \"Payment failed. Please check your card details and try again.\"\n      );\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <form onSubmit={handleSubmit} className=\"payment-form\">\n      <h3>Billing Information</h3>\n      <input\n        type=\"text\"\n        name=\"name\"\n        placeholder=\"Cardholder Name\"\n        value={billingDetails.name}\n        onChange={handleChange}\n        required\n      />\n      <input\n        type=\"email\"\n        name=\"email\"\n        placeholder=\"Email\"\n        value={billingDetails.email}\n        onChange={handleChange}\n        required\n      />\n      <input\n        type=\"text\"\n        name=\"line1\"\n        placeholder=\"Street Address\"\n        value={billingDetails.line1}\n        onChange={handleChange}\n        required\n      />\n      <input\n        type=\"text\"\n        name=\"city\"\n        placeholder=\"City\"\n        value={billingDetails.city}\n        onChange={handleChange}\n        required\n      />\n      <input\n        type=\"text\"\n        name=\"postcode\"\n        placeholder=\"Postcode\"\n        value={billingDetails.postcode}\n        onChange={handleChange}\n        required\n      />\n\n      {/* üíé Redeem Points Section */}\n      {userPoints > 0 && (\n        <div\n          style={{\n            border: \"1px solid #ddd\",\n            borderRadius: \"8px\",\n            padding: \"10px\",\n            margin: \"15px 0\",\n            background: \"#f8f8f8\",\n          }}\n        >\n          <h4>Redeem Loyalty Points</h4>\n          <p>\n            You have <strong>{userPoints}</strong> points ( ¬£\n            {(userPoints * 0.01).toFixed(2)} value)\n          </p>\n          <input\n            type=\"number\"\n            value={pointsToUse}\n            onChange={(e) => setPointsToUse(Number(e.target.value))}\n            min=\"0\"\n            max={userPoints}\n            style={{ marginRight: \"10px\", padding: \"5px\" }}\n          />\n          <button\n            type=\"button\"\n            onClick={handleApplyPoints}\n            style={{\n              background: \"#ff385c\",\n              color: \"#fff\",\n              border: \"none\",\n              padding: \"5px 10px\",\n              borderRadius: \"5px\",\n              cursor: \"pointer\",\n            }}\n          >\n            Apply\n          </button>\n          {discount > 0 && (\n            <p style={{ marginTop: \"5px\" }}>\n              Discount applied: <strong>¬£{discount.toFixed(2)}</strong>\n            </p>\n          )}\n        </div>\n      )}\n\n      {/* üßæ Summary Section */}\n      <div\n        style={{\n          borderTop: \"1px solid #ddd\",\n          marginTop: \"15px\",\n          paddingTop: \"10px\",\n          fontSize: \"0.95rem\",\n        }}\n      >\n        <p>\n          <strong>Subtotal:</strong> ¬£{subtotal.toFixed(2)}\n        </p>\n        <p>\n          <strong>Discount:</strong>{\" \"}\n          {discount > 0 ? `-¬£${discount.toFixed(2)}` : \"¬£0.00\"}\n        </p>\n        <p>\n          <strong>Total to Pay:</strong>{\" \"}\n          <span style={{ color: \"#ff385c\", fontSize: \"1.1em\" }}>\n            ¬£{total.toFixed(2)}\n          </span>\n        </p>\n      </div>\n\n      <h3 style={{ marginTop: \"20px\" }}>Payment</h3>\n      <div style={{ border: \"1px solid #ddd\", padding: 10, borderRadius: 6 }}>\n        <CardElement options={{ hidePostalCode: true }} />\n      </div>\n\n      <button\n        type=\"submit\"\n        disabled={!stripe || loading}\n        className=\"btn-primary\"\n        style={{ marginTop: 12 }}\n      >\n        {loading ? \"Processing...\" : `Pay ¬£${total.toFixed(2)}`}\n      </button>\n    </form>\n  );\n}\n\nexport default function Payment() {\n  const location = useLocation();\n  const { address, cart } = location.state || { address: {}, cart: [] };\n\n  return (\n    <Elements stripe={stripePromise}>\n      <div className=\"payment-container\">\n        <h2>Payment</h2>\n        <CheckoutForm address={address} cart={cart} />\n      </div>\n    </Elements>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}