{"ast":null,"code":"var _jsxFileName = \"/Users/sibtulhassan/Downloads/ohmyfood-fullstack/client/src/pages/Payment.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { useContext, useEffect, useState } from \"react\";\nimport { useLocation, useNavigate } from \"react-router-dom\";\nimport { loadStripe } from \"@stripe/stripe-js\";\nimport { CartContext } from \"../context/CartContext\";\nimport { Elements, CardElement, useStripe, useElements } from \"@stripe/react-stripe-js\";\nimport API from \"../api\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst stripePromise = loadStripe(\"pk_test_51SL4gHFrLsiRJStWdnqFsEdHiiDQYDvTOGEe53lwevsgEMz2PxhP4QjKcqgbf8h2N8EKmkIXIDLfELusYLepJqNE00oIRsCveh\");\nfunction CheckoutForm({\n  address,\n  cart\n}) {\n  _s();\n  const stripe = useStripe();\n  const elements = useElements();\n  const navigate = useNavigate();\n  const {\n    clearCart\n  } = useContext(CartContext);\n  const [loading, setLoading] = useState(false);\n  const total = cart.reduce((sum, item) => sum + (item.price || 0) * (item.qty || 0), 0);\n  const [billingDetails, setBillingDetails] = useState({\n    name: \"\",\n    email: \"\",\n    line1: \"\",\n    city: \"\",\n    country: \"GB\",\n    // default to UK\n    postal_code: \"\"\n  });\n  const [savedAddress, setSavedAddress] = useState(address || {});\n\n  // ✅ Fetch user's saved profile info\n  useEffect(() => {\n    const fetchProfile = async () => {\n      try {\n        const {\n          data\n        } = await API.get(\"/api/users/profile\", {\n          headers: {\n            Authorization: `Bearer ${localStorage.getItem(\"token\")}`\n          }\n        });\n        if (data !== null && data !== void 0 && data.address) setSavedAddress(data.address);\n        if (data !== null && data !== void 0 && data.billingDetails) setBillingDetails(prev => ({\n          ...prev,\n          ...data.billingDetails\n        }));\n      } catch (err) {\n        var _err$response;\n        console.warn(\"No saved profile / fetch failed:\", (err === null || err === void 0 ? void 0 : (_err$response = err.response) === null || _err$response === void 0 ? void 0 : _err$response.data) || err.message);\n      }\n    };\n    fetchProfile();\n  }, []);\n\n  // ✅ Handle field change (auto-uppercase postcode)\n  const handleChange = e => {\n    const {\n      name,\n      value\n    } = e.target;\n    setBillingDetails({\n      ...billingDetails,\n      [name]: name === \"postal_code\" ? value.toUpperCase().replace(/\\s+/g, \"\") : value\n    });\n  };\n  const handleSubmit = async e => {\n    e.preventDefault();\n    const token = localStorage.getItem(\"token\");\n    if (!token) {\n      alert(\"You must be logged in to make a payment.\");\n      return;\n    }\n    if (!stripe || !elements) {\n      alert(\"Stripe is not ready. Try again in a moment.\");\n      return;\n    }\n    setLoading(true);\n    try {\n      var _createResp$data, _confirmResult$paymen;\n      // 1️⃣ Create payment intent\n      const amount = Math.round(total * 100);\n      const createResp = await API.post(\"/api/payment/create-payment-intent\", {\n        amount\n      }, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      const clientSecret = (_createResp$data = createResp.data) === null || _createResp$data === void 0 ? void 0 : _createResp$data.clientSecret;\n      if (!clientSecret) throw new Error(\"No clientSecret returned from server.\");\n\n      // 2️⃣ Confirm card payment\n      const card = elements.getElement(CardElement);\n      if (!card) throw new Error(\"Card element not mounted.\");\n      const confirmResult = await stripe.confirmCardPayment(clientSecret, {\n        payment_method: {\n          card,\n          billing_details: {\n            name: billingDetails.name,\n            email: billingDetails.email,\n            address: {\n              line1: billingDetails.line1,\n              city: billingDetails.city,\n              country: billingDetails.country,\n              postal_code: billingDetails.postal_code\n            }\n          }\n        }\n      });\n      if (confirmResult.error) throw confirmResult.error;\n      if (((_confirmResult$paymen = confirmResult.paymentIntent) === null || _confirmResult$paymen === void 0 ? void 0 : _confirmResult$paymen.status) !== \"succeeded\") {\n        var _confirmResult$paymen2;\n        throw new Error(\"Payment did not succeed. Status: \" + (((_confirmResult$paymen2 = confirmResult.paymentIntent) === null || _confirmResult$paymen2 === void 0 ? void 0 : _confirmResult$paymen2.status) || \"unknown\"));\n      }\n\n      // 3️⃣ Save order to server\n      const savedOrderResp = await API.post(\"/api/orders\", {\n        items: cart,\n        totalAmount: total,\n        restaurantId: cart.length > 0 ? cart[0].restaurantId : null,\n        address: {\n          street: savedAddress.street || address.street,\n          postcode: savedAddress.postcode || address.postcode,\n          county: savedAddress.county || address.county,\n          country: savedAddress.country || address.country\n        }\n      }, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n\n      // 4️⃣ Save billing + address to profile (non-fatal if fails)\n      try {\n        await API.put(\"/api/users/profile\", {\n          address: savedAddress,\n          billingDetails\n        }, {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n      } catch (profileErr) {\n        var _profileErr$response;\n        console.warn(\"Failed to update profile:\", (profileErr === null || profileErr === void 0 ? void 0 : (_profileErr$response = profileErr.response) === null || _profileErr$response === void 0 ? void 0 : _profileErr$response.data) || profileErr.message);\n      }\n\n      // 5️⃣ Clear cart\n      if (typeof clearCart === \"function\") clearCart();\n      localStorage.removeItem(\"cart\");\n\n      // 6️⃣ Redirect to confirmation\n      navigate(\"/order-confirmation\", {\n        state: {\n          orderId: savedOrderResp.data._id,\n          total: savedOrderResp.data.totalAmount || total\n        },\n        replace: true\n      });\n    } catch (err) {\n      var _err$raw;\n      console.error(\"❌ Payment error:\", err);\n      const msg = (err === null || err === void 0 ? void 0 : err.message) || (err === null || err === void 0 ? void 0 : err.type) || (err === null || err === void 0 ? void 0 : err.error) || (err === null || err === void 0 ? void 0 : (_err$raw = err.raw) === null || _err$raw === void 0 ? void 0 : _err$raw.message) || (err === null || err === void 0 ? void 0 : err.response) && (err.response.data || err.response.statusText) || \"Payment failed. Please check your details and try again.\";\n      alert(msg);\n    } finally {\n      setLoading(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"form\", {\n    onSubmit: handleSubmit,\n    className: \"payment-form\",\n    children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n      style: {\n        marginBottom: 10\n      },\n      children: \"Billing Information\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"text\",\n      name: \"name\",\n      placeholder: \"Cardholder Name\",\n      value: billingDetails.name,\n      onChange: handleChange,\n      required: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"email\",\n      name: \"email\",\n      placeholder: \"Email\",\n      value: billingDetails.email,\n      onChange: handleChange,\n      required: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"text\",\n      name: \"line1\",\n      placeholder: \"Street Address\",\n      value: billingDetails.line1,\n      onChange: handleChange,\n      required: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"text\",\n      name: \"city\",\n      placeholder: \"City\",\n      value: billingDetails.city,\n      onChange: handleChange,\n      required: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"text\",\n      name: \"country\",\n      placeholder: \"Country\",\n      value: billingDetails.country,\n      onChange: handleChange,\n      required: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 224,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"text\",\n      name: \"postal_code\",\n      placeholder: \"Postcode\",\n      value: billingDetails.postal_code,\n      onChange: handleChange,\n      required: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 232,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n      style: {\n        marginTop: 20,\n        marginBottom: 10\n      },\n      children: \"Payment\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 241,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        border: \"1px solid #ddd\",\n        padding: 10,\n        borderRadius: 6\n      },\n      children: /*#__PURE__*/_jsxDEV(CardElement, {\n        options: {\n          hidePostalCode: true,\n          // ✅ Hide Stripe's ZIP field\n          style: {\n            base: {\n              fontSize: \"16px\",\n              color: \"#424770\",\n              \"::placeholder\": {\n                color: \"#aab7c4\"\n              }\n            },\n            invalid: {\n              color: \"#9e2146\"\n            }\n          }\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 249,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 242,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"submit\",\n      disabled: !stripe || loading,\n      className: \"btn-primary\",\n      style: {\n        marginTop: 15\n      },\n      children: loading ? \"Processing...\" : `Pay £${total.toFixed(2)}`\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 264,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 189,\n    columnNumber: 5\n  }, this);\n}\n_s(CheckoutForm, \"E10dpABsaLeu+7nojEaKK1EKr1Q=\", false, function () {\n  return [useStripe, useElements, useNavigate];\n});\n_c = CheckoutForm;\nexport default function Payment() {\n  _s2();\n  const location = useLocation();\n  const {\n    address,\n    cart\n  } = location.state || {\n    address: {},\n    cart: []\n  };\n  return /*#__PURE__*/_jsxDEV(Elements, {\n    stripe: stripePromise,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"payment-container\",\n      style: {\n        maxWidth: 500,\n        margin: \"0 auto\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        style: {\n          textAlign: \"center\",\n          marginBottom: 20\n        },\n        children: \"Payment\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 286,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(CheckoutForm, {\n        address: address,\n        cart: cart\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 287,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 282,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 281,\n    columnNumber: 5\n  }, this);\n}\n_s2(Payment, \"pkHmaVRPskBaU4tMJuJJpV42k1I=\", false, function () {\n  return [useLocation];\n});\n_c2 = Payment;\nvar _c, _c2;\n$RefreshReg$(_c, \"CheckoutForm\");\n$RefreshReg$(_c2, \"Payment\");","map":{"version":3,"names":["React","useContext","useEffect","useState","useLocation","useNavigate","loadStripe","CartContext","Elements","CardElement","useStripe","useElements","API","jsxDEV","_jsxDEV","stripePromise","CheckoutForm","address","cart","_s","stripe","elements","navigate","clearCart","loading","setLoading","total","reduce","sum","item","price","qty","billingDetails","setBillingDetails","name","email","line1","city","country","postal_code","savedAddress","setSavedAddress","fetchProfile","data","get","headers","Authorization","localStorage","getItem","prev","err","_err$response","console","warn","response","message","handleChange","e","value","target","toUpperCase","replace","handleSubmit","preventDefault","token","alert","_createResp$data","_confirmResult$paymen","amount","Math","round","createResp","post","clientSecret","Error","card","getElement","confirmResult","confirmCardPayment","payment_method","billing_details","error","paymentIntent","status","_confirmResult$paymen2","savedOrderResp","items","totalAmount","restaurantId","length","street","postcode","county","put","profileErr","_profileErr$response","removeItem","state","orderId","_id","_err$raw","msg","type","raw","statusText","onSubmit","className","children","style","marginBottom","fileName","_jsxFileName","lineNumber","columnNumber","placeholder","onChange","required","marginTop","border","padding","borderRadius","options","hidePostalCode","base","fontSize","color","invalid","disabled","toFixed","_c","Payment","_s2","location","maxWidth","margin","textAlign","_c2","$RefreshReg$"],"sources":["/Users/sibtulhassan/Downloads/ohmyfood-fullstack/client/src/pages/Payment.js"],"sourcesContent":["import React, { useContext, useEffect, useState } from \"react\";\nimport { useLocation, useNavigate } from \"react-router-dom\";\nimport { loadStripe } from \"@stripe/stripe-js\";\nimport { CartContext } from \"../context/CartContext\";\nimport {\n  Elements,\n  CardElement,\n  useStripe,\n  useElements,\n} from \"@stripe/react-stripe-js\";\nimport API from \"../api\";\n\nconst stripePromise = loadStripe(\n  \"pk_test_51SL4gHFrLsiRJStWdnqFsEdHiiDQYDvTOGEe53lwevsgEMz2PxhP4QjKcqgbf8h2N8EKmkIXIDLfELusYLepJqNE00oIRsCveh\"\n);\n\nfunction CheckoutForm({ address, cart }) {\n  const stripe = useStripe();\n  const elements = useElements();\n  const navigate = useNavigate();\n  const { clearCart } = useContext(CartContext);\n  const [loading, setLoading] = useState(false);\n\n  const total = cart.reduce(\n    (sum, item) => sum + (item.price || 0) * (item.qty || 0),\n    0\n  );\n\n  const [billingDetails, setBillingDetails] = useState({\n    name: \"\",\n    email: \"\",\n    line1: \"\",\n    city: \"\",\n    country: \"GB\", // default to UK\n    postal_code: \"\",\n  });\n\n  const [savedAddress, setSavedAddress] = useState(address || {});\n\n  // ✅ Fetch user's saved profile info\n  useEffect(() => {\n    const fetchProfile = async () => {\n      try {\n        const { data } = await API.get(\"/api/users/profile\", {\n          headers: { Authorization: `Bearer ${localStorage.getItem(\"token\")}` },\n        });\n        if (data?.address) setSavedAddress(data.address);\n        if (data?.billingDetails)\n          setBillingDetails((prev) => ({\n            ...prev,\n            ...data.billingDetails,\n          }));\n      } catch (err) {\n        console.warn(\n          \"No saved profile / fetch failed:\",\n          err?.response?.data || err.message\n        );\n      }\n    };\n    fetchProfile();\n  }, []);\n\n  // ✅ Handle field change (auto-uppercase postcode)\n  const handleChange = (e) => {\n    const { name, value } = e.target;\n    setBillingDetails({\n      ...billingDetails,\n      [name]:\n        name === \"postal_code\"\n          ? value.toUpperCase().replace(/\\s+/g, \"\")\n          : value,\n    });\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    const token = localStorage.getItem(\"token\");\n\n    if (!token) {\n      alert(\"You must be logged in to make a payment.\");\n      return;\n    }\n    if (!stripe || !elements) {\n      alert(\"Stripe is not ready. Try again in a moment.\");\n      return;\n    }\n\n    setLoading(true);\n    try {\n      // 1️⃣ Create payment intent\n      const amount = Math.round(total * 100);\n      const createResp = await API.post(\n        \"/api/payment/create-payment-intent\",\n        { amount },\n        { headers: { Authorization: `Bearer ${token}` } }\n      );\n\n      const clientSecret = createResp.data?.clientSecret;\n      if (!clientSecret)\n        throw new Error(\"No clientSecret returned from server.\");\n\n      // 2️⃣ Confirm card payment\n      const card = elements.getElement(CardElement);\n      if (!card) throw new Error(\"Card element not mounted.\");\n\n      const confirmResult = await stripe.confirmCardPayment(clientSecret, {\n        payment_method: {\n          card,\n          billing_details: {\n            name: billingDetails.name,\n            email: billingDetails.email,\n            address: {\n              line1: billingDetails.line1,\n              city: billingDetails.city,\n              country: billingDetails.country,\n              postal_code: billingDetails.postal_code,\n            },\n          },\n        },\n      });\n\n      if (confirmResult.error) throw confirmResult.error;\n      if (confirmResult.paymentIntent?.status !== \"succeeded\") {\n        throw new Error(\n          \"Payment did not succeed. Status: \" +\n            (confirmResult.paymentIntent?.status || \"unknown\")\n        );\n      }\n\n      // 3️⃣ Save order to server\n      const savedOrderResp = await API.post(\n        \"/api/orders\",\n        {\n          items: cart,\n          totalAmount: total,\n          restaurantId: cart.length > 0 ? cart[0].restaurantId : null,\n          address: {\n            street: savedAddress.street || address.street,\n            postcode: savedAddress.postcode || address.postcode,\n            county: savedAddress.county || address.county,\n            country: savedAddress.country || address.country,\n          },\n        },\n        { headers: { Authorization: `Bearer ${token}` } }\n      );\n\n      // 4️⃣ Save billing + address to profile (non-fatal if fails)\n      try {\n        await API.put(\n          \"/api/users/profile\",\n          { address: savedAddress, billingDetails },\n          { headers: { Authorization: `Bearer ${token}` } }\n        );\n      } catch (profileErr) {\n        console.warn(\n          \"Failed to update profile:\",\n          profileErr?.response?.data || profileErr.message\n        );\n      }\n\n      // 5️⃣ Clear cart\n      if (typeof clearCart === \"function\") clearCart();\n      localStorage.removeItem(\"cart\");\n\n      // 6️⃣ Redirect to confirmation\n      navigate(\"/order-confirmation\", {\n        state: {\n          orderId: savedOrderResp.data._id,\n          total: savedOrderResp.data.totalAmount || total,\n        },\n        replace: true,\n      });\n    } catch (err) {\n      console.error(\"❌ Payment error:\", err);\n      const msg =\n        err?.message ||\n        err?.type ||\n        err?.error ||\n        err?.raw?.message ||\n        (err?.response && (err.response.data || err.response.statusText)) ||\n        \"Payment failed. Please check your details and try again.\";\n      alert(msg);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <form onSubmit={handleSubmit} className=\"payment-form\">\n      <h3 style={{ marginBottom: 10 }}>Billing Information</h3>\n\n      <input\n        type=\"text\"\n        name=\"name\"\n        placeholder=\"Cardholder Name\"\n        value={billingDetails.name}\n        onChange={handleChange}\n        required\n      />\n      <input\n        type=\"email\"\n        name=\"email\"\n        placeholder=\"Email\"\n        value={billingDetails.email}\n        onChange={handleChange}\n        required\n      />\n      <input\n        type=\"text\"\n        name=\"line1\"\n        placeholder=\"Street Address\"\n        value={billingDetails.line1}\n        onChange={handleChange}\n        required\n      />\n      <input\n        type=\"text\"\n        name=\"city\"\n        placeholder=\"City\"\n        value={billingDetails.city}\n        onChange={handleChange}\n        required\n      />\n      <input\n        type=\"text\"\n        name=\"country\"\n        placeholder=\"Country\"\n        value={billingDetails.country}\n        onChange={handleChange}\n        required\n      />\n      <input\n        type=\"text\"\n        name=\"postal_code\"\n        placeholder=\"Postcode\"\n        value={billingDetails.postal_code}\n        onChange={handleChange}\n        required\n      />\n\n      <h3 style={{ marginTop: 20, marginBottom: 10 }}>Payment</h3>\n      <div\n        style={{\n          border: \"1px solid #ddd\",\n          padding: 10,\n          borderRadius: 6,\n        }}\n      >\n        <CardElement\n          options={{\n            hidePostalCode: true, // ✅ Hide Stripe's ZIP field\n            style: {\n              base: {\n                fontSize: \"16px\",\n                color: \"#424770\",\n                \"::placeholder\": { color: \"#aab7c4\" },\n              },\n              invalid: { color: \"#9e2146\" },\n            },\n          }}\n        />\n      </div>\n\n      <button\n        type=\"submit\"\n        disabled={!stripe || loading}\n        className=\"btn-primary\"\n        style={{ marginTop: 15 }}\n      >\n        {loading ? \"Processing...\" : `Pay £${total.toFixed(2)}`}\n      </button>\n    </form>\n  );\n}\n\nexport default function Payment() {\n  const location = useLocation();\n  const { address, cart } = location.state || { address: {}, cart: [] };\n\n  return (\n    <Elements stripe={stripePromise}>\n      <div\n        className=\"payment-container\"\n        style={{ maxWidth: 500, margin: \"0 auto\" }}\n      >\n        <h2 style={{ textAlign: \"center\", marginBottom: 20 }}>Payment</h2>\n        <CheckoutForm address={address} cart={cart} />\n      </div>\n    </Elements>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}